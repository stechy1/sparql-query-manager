<section>
  <div class="row" *ngIf="queries.length !== 0">
    <div class="col s12 offset-m2 m8">
      <label>
        <input type="text" placeholder="Najít dotaz...">
      </label>
    </div>
  </div>
  <div class="row" *ngIf="queries.length !== 0">
    <div class="col s12 center-align">
      <span>Seskupit dotazy podle:</span>
      <form action="#" [formGroup]="formGroupBy" style="display: inline;">
      <label>
        <input type="radio" formControlName="groupBy" value="none"/>
        <span class="group-by-select">Ničeho</span>
      </label>
      <label>
        <input type="radio" formControlName="groupBy" value="endpoint"/>
        <span class="group-by-select">Endpointu</span>
      </label>
      <label>
        <input type="radio" formControlName="groupBy" value="tag"/>
        <span class="group-by-select">Tagu</span>
      </label>
      </form>
    </div>
  </div>
  <div class="row" *ngIf="queries.length !== 0">
    <div class="col s12 center-align">
      <span>Seřadit dotazy podle:</span>
      <form action="#" [formGroup]="formOrderBy" style="display: inline;">
        <label>
          <input type="radio" formControlName="orderBy" value="last_run"/>
          <span class="group-by-select">Posledního spuštění</span>
        </label>
        <label>
          <input type="radio" formControlName="orderBy" value="date_of_creation"/>
          <span class="group-by-select">Datumu vytvoření</span>
        </label>
        <label>
          <input type="radio" formControlName="orderBy" value="count_of_run"/>
          <span class="group-by-select">Počtu spuštění</span>
        </label>
        <label>
          <input type="radio" formControlName="orderBy" value="alphabeticaly"/>
          <span class="group-by-select">Abecedně</span>
        </label>
      </form>
    </div>
  </div>
  <div class="row" *ngIf="queries.length !== 0">
    <div class="col s12 center-align">
      <span>Orientace řazení:</span>
      <form action="#" [formGroup]="formOrderType" style="display: inline;">
        <label>
          <input type="radio" formControlName="orderType" value="ascending"/>
          <span class="group-by-select">Vzestupně</span>
        </label>
        <label>
          <input type="radio" formControlName="orderType" value="descending"/>
          <span class="group-by-select">Sestupně</span>
        </label>
      </form>
    </div>
  </div>
  <div class="row">
    <div class="col s12 offset-m2 m8">
      <div class="collection" *ngIf="queries.length !== 0">
        <mat-selection-list #querySelectionList (selectionChange)="handleQuerySelectionChange($event)">
          <div class="collection-item" *ngIf="formGroupBy.value['groupBy'] === 'none'">
            <mat-list-option *ngFor="let query of queries" [value]="query.id">
              <app-q-entry [query]="query" (deleteRequest)="handleDeleteRequest($event)"></app-q-entry>
            </mat-list-option>
          </div>
          <div class="collection-item" *ngIf="formGroupBy.value['groupBy'] === 'endpoint'">
            <div *ngFor="let endpoint of endpoints">
              <h5>{{endpoint}}</h5>
              <mat-list-option *ngFor="let query of getQueriesByEndpoint(endpoint)" [value]="query.id">
                <app-q-entry [query]="query" (deleteRequest)="handleDeleteRequest($event)"></app-q-entry>
              </mat-list-option>
              <div class="divider"></div>
            </div>
          </div>
          <div class="collection-item" *ngIf="formGroupBy.value['groupBy'] === 'tag'">
            <div *ngFor="let tag of tags">
              <h5>{{tag}}</h5>
              <mat-list-option *ngFor="let query of getQueriesByTag(tag)" [value]="query.id">
                <app-q-entry [query]="query" (deleteRequest)="handleDeleteRequest($event)"></app-q-entry>
              </mat-list-option>
              <div class="divider"></div>
            </div>
          </div>
        </mat-selection-list>

        Označeno dotazů: {{querySelectionList.selectedOptions.selected.length}}
        <div class="col s12 button-bar-wrapper">
          <div class="button-bar">
            <div class="col s6 m1 center-on-small-only">
              <button class="btn btn-tiny" (click)="handleExport()" [disabled]="selectedQueries.length === 0">Export</button>
            </div>
            <div class="col s6 m1 offset-m1 center-on-small-only">
              <button [matMenuTriggerFor]="importMenu" class="btn btn-tiny center-align">Import</button>
              <mat-menu #importMenu="matMenu">
                <label for="btnImportOverride" mat-menu-item>
                  Přepsat
                  <input id="btnImportOverride" type="file" style="display: none" (change)="handleImportOverride($event)"/>
                </label>
                <label mat-menu-item>
                  Připnout
                  <input id="btnImportAppend" type="file" style="display: none;" (change)="handleImportAppend($event)"/>
                </label>
              </mat-menu>
            </div>
            <div class="col s4 m2 offset-m3 offset-l3 center-on-small-only">
              <button class="btn btn-tiny" (click)="handleSelectAll()" [disabled]="selectedQueries.length === queries.length">Vybrat vše</button>
            </div>
            <div class="col s4 m2 center-on-small-only">
              <button class="btn btn-tiny" (click)="handleSelectNone()" [disabled]="selectedQueries.length === 0">Zrušit vše</button>
            </div>
            <div class="col s4 m2 center-on-small-only">
              <button class="btn btn-tiny red" (click)="handleDeleteAll()">Smazat vše</button>
            </div>
          </div>
        </div>
      </div>
      <div *ngIf="queries.length === 0" class="col s12 center-align">
        <h1>Nebyly nalezeny žádné dotazy.</h1>
        <a routerLink="/new">Vytvořte nový dotaz</a>
        nebo
        <label for="btnImport" class="btn btn-small">
          Importovat databázi
          <input id="btnImport" type="file" style="display: none" (change)="handleImportOverride($event)"/>
        </label>
      </div>
    </div>
  </div>

</section>

<a routerLink="/new" id="new-query" class="btn-floating btn-large waves-effect waves-light red"><i class="material-icons">add</i></a>
